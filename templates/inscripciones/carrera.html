{% extends "ui/base.html" %}
{% load static form_extras %}

{% block title %}Inscripción a Carrera · IPES{% endblock %}
{% block nav_insc %}active{% endblock %}
{% block nav_insc_carrera %}active{% endblock %}

{% block content %}
  <div class="panel">
    <h1>Inscripción a Carrera</h1>

    <form id="insc-carrera-form" method="post" action="{{ request.path }}"
          data-planes-url="{% url 'ui:api_planes' %}"
          data-prefill-est="{{ request.GET.est|default:'' }}">
      {% csrf_token %}
      {{ form.non_field_errors }}

      <div class="form-grid">
        <div>
          <label for="{{ form.estudiante.id_for_label }}">Estudiante</label>
          {{ form.estudiante|addclass:"select" }}
        </div>

        <div>
          <label for="{{ form.profesorado.id_for_label }}">Profesorado / Carrera</label>
          {{ form.profesorado|addclass:"select" }}
        </div>

        <div>
          <label for="{{ form.plan.id_for_label }}">Plan</label>
          {{ form.plan|addclass:"select" }}
          <div id="plan-error" class="muted hidden" style="color:#b91c1c; font-size:12px;"></div>
        </div>

        <div>
          <label for="{{ form.cohorte.id_for_label }}">Cohorte</label>
          {{ form.cohorte|addclass:"input" }}
        </div>

        {# ------- Opcionales: solo se muestran si existen o si querés usarlos ------- #}
        {% if form.turno %}
        <div>
          <label for="{{ form.turno.id_for_label }}">Turno</label>
          {{ form.turno|addclass:"input" }}
        </div>
        {% endif %}

        {% if form.estado %}
        <div>
          <label for="{{ form.estado.id_for_label }}">Estado</label>
          {{ form.estado|addclass:"select" }}
        </div>
        {% endif %}
        {# --------------------------------------------------------------------------- #}
      </div>

      <div class="panel" style="margin-top:16px">
        <h2>Requisitos de Ingreso</h2>

        <div class="form-grid">
          <div class="checkbox">
            {{ form.req_dni }} <label for="{{ form.req_dni.id_for_label }}">{{ form.req_dni.label }}</label>
          </div>
          <div class="checkbox">
            {{ form.req_cert_med }} <label for="{{ form.req_cert_med.id_for_label }}">{{ form.req_cert_med.label }}</label>
          </div>
          <div class="checkbox">
            {{ form.req_fotos }} <label for="{{ form.req_fotos.id_for_label }}">{{ form.req_fotos.label }}</label>
          </div>
          <div class="checkbox">
            {{ form.req_folios }} <label for="{{ form.req_folios.id_for_label }}">{{ form.req_folios.label }}</label>
          </div>
        </div>

        <div class="form-grid" style="margin-top:8px">
          <div id="row-titulo-sec" class="checkbox">
            {{ form.req_titulo_sec }} <label for="{{ form.req_titulo_sec.id_for_label }}">{{ form.req_titulo_sec.label }}</label>
          </div>
          <div id="row-titulo-tramite" class="checkbox">
            {{ form.req_titulo_tramite }} <label for="{{ form.req_titulo_tramite.id_for_label }}">{{ form.req_titulo_tramite.label }}</label>
          </div>
          <div id="row-adeuda" class="checkbox">
            {{ form.req_adeuda }} <label for="{{ form.req_adeuda.id_for_label }}">{{ form.req_adeuda.label }}</label>
          </div>
        </div>

        <div id="adeuda-extra" class="form-grid hidden" style="margin-top:8px">
          <div>
            <label for="{{ form.req_adeuda_mats.id_for_label }}">{{ form.req_adeuda_mats.label }}</label>
            {{ form.req_adeuda_mats|addclass:"input" }}
          </div>
          <div>
            <label for="{{ form.req_adeuda_inst.id_for_label }}">{{ form.req_adeuda_inst.label }}</label>
            {{ form.req_adeuda_inst|addclass:"input" }}
          </div>
        </div>

        <div id="req-cert-docente" class="form-grid hidden" style="margin-top:12px">
          <h3 class="muted" style="margin:0 0 6px">Documentación de Nivel Superior</h3>
          <div class="form-grid">
            <div class="checkbox">
              {{ form.req_titulo_sup }} <label for="{{ form.req_titulo_sup.id_for_label }}">{{ form.req_titulo_sup.label }}</label>
            </div>
            <div class="checkbox">
              {{ form.req_incumbencias }} <label for="{{ form.req_incumbencias.id_for_label }}">{{ form.req_incumbencias.label }}</label>
            </div>
          </div>
        </div>

        <div class="checkbox" style="margin-top:8px">
          {{ form.req_condicion }} <label for="{{ form.req_condicion.id_for_label }}">{{ form.req_condicion.label }}</label>
        </div>
      </div>

      {# Estado administrativo (tu JS maneja estas pills) #}
      <div class="row" style="margin-top:12px; gap:8px">
        <span id="pill-regular" class="hidden px-3 py-1 rounded-full bg-emerald-100 text-emerald-800 text-sm">Alumno Regular Administrativamente</span>
        <span id="pill-cond" class="hidden px-3 py-1 rounded-full bg-amber-100 text-amber-800 text-sm">Alumno Condicional</span>
        <label id="ddjj-wrap" class="hidden checkbox" style="margin-left:auto">
          {{ form.ddjj_compromiso }} <span>{{ form.ddjj_compromiso.label }}</span>
        </label>
      </div>

      <div class="actions">
        <button class="btn btn-primary" type="submit">Guardar Inscripción</button>
        <button type="button" class="btn btn-ghost" onclick="history.back()">Cancelar</button>
      </div>
    </form>
  </div>

  <script>
    window.CERT_DOCENTE_LABEL = "{{ CERT_DOCENTE_LABEL|default:'Certificación Docente para la Educación Secundaria' }}";
  </script>
  <script src="{% static 'ui/js/inscripcion_carrera.js' %}"></script>
{% endblock %}