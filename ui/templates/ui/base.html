{% load static %}
<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>{% block title %}IPES Paulo Freire{% endblock %}</title>
  <link rel="stylesheet" href="{% static 'ui/css/tema-ipes.css' %}?v=7">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Topbar VERDE, ancho completo -->
  <header class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <img src="{% static 'academia_core/escudo.png' %}" alt="Escudo IPES" class="brand-img">
        <span class="brand-title">IPES Paulo Freire</span>
      </div>
      <div class="account">
        Usuario: {{ request.user|default:'—' }} &nbsp;•&nbsp;
        <a href="{% url 'logout' %}">Cerrar sesión</a>
      </div>
    </div>
  </header>

  <!-- Cuerpo: sidebar + contenido -->
  <div class="app">
    <aside class="sidebar">
  <div class="sidebar-title">Panel de Gestión</div>

  <nav class="nav">

    <a href="{% url 'ui:dashboard' %}" class="{% block nav_dashboard %}{% endblock %}">Panel</a>

    <!-- Cursos (si querés submenú, copiá el patrón de Estudiantes) -->
    <a href="#" class="{% block nav_cursos %}{% endblock %}">Cursos</a>

    <!-- Estudiantes con submenú en modo acordeón -->
    <div class="nav-item has-children {% block open_estudiantes %}{% endblock %}">
      <a href="#" class="nav-parent">Estudiantes</a>
      <div class="subnav" id="sub-estudiantes">
        <a href="{% url 'ui:estudiantes_list' %}" class="{% block nav_estudiantes_list %}{% endblock %}">Listado</a>
        <a href="{% url 'ui:estudiante_nuevo' %}" class="{% block nav_estudiantes_new %}{% endblock %}">Nuevo Estudiante</a>
      </div>
    </div>

    <a href="#" class="{% block nav_horarios %}{% endblock %}">Horarios</a>

    <!-- INSCRIPCIÓN con submenú -->
    <div class="nav-item has-children {% block open_insc %}{% endblock %}">
      <a href="#" class="nav-parent">Inscripción</a>
      <div class="subnav">
        <a href="{% url 'insc_carrera_new' %}" class="{% block nav_insc_carrera %}{% endblock %}">a Carrera</a>
        <a href="{% url 'insc_materia_new' %}" class="{% block nav_insc_materia %}{% endblock %}">a Materia</a>
        <a href="{% url 'insc_mesa_new' %}" class="{% block nav_insc_mesa %}{% endblock %}">a Mesa</a>
      </div>
    </div>
  </nav>
</aside>

    <main class="main">
      <div class="container">
        {% block content %}{% endblock %}
      </div>
    </main>
  </div>
<script>
(function () {
  const items = document.querySelectorAll('.nav-item.has-children');

  // Cierra todos y abre el clickeado (acordeón)
  function openOnly(item) {
    items.forEach(i => i.classList.toggle('open', i === item));
  }

  // Toggle al hacer click en el padre
  items.forEach(item => {
    const parent = item.querySelector('.nav-parent');
    parent.addEventListener('click', (e) => {
      e.preventDefault();
      const isOpen = item.classList.contains('open');
      items.forEach(i => i.classList.remove('open'));
      if (!isOpen) item.classList.add('open');
    });
  });

  // Si hay un hijo activo en esta página, que arranque abierto
  items.forEach(item => {
    if (item.querySelector('.subnav a.active')) {
      item.classList.add('open');
    }
  });
})();
</script>
</body>
</html>